<html>
    <head>
        <meta charset="UTF-8" />
        <title>Network Graph</title>
        <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    </head>
    <body>
        <div id="main" style="width: 100%; height: 800px"></div>
        <script>
            var myChart = echarts.init(document.getElementById("main"));

            fetch("test2.json")
                .then((response) => response.json())
                .then((data) => {
                    const categories = [
                        {
                            name: "REF",
                            itemStyle: {
                                color: "#3E54AC",
                            },
                        },
                        {
                            name: "ALT",
                            itemStyle: {
                                color: "#B01E68",
                            },
                        },
                    ];

                    var option = {
                        title: {
                            text: "Network Graph",
                        },
                        tooltip: {
                            formatter: function (params) {
                                if (params.dataType === "node") {
                                    return `ID: ${params.data.name}<br/>
                                            Seq: ${params.data.value.Sequence}<br/>
                                            Status: ${params.data.value.Status}<br/>
                                    `;
                                }
                                return "";
                            },
                        },
                        legend: {
                            data: categories.map((c) => c.name),
                            show: true,
                        },
                        animationDurationUpdate: 1500,
                        animationEasingUpdate: "quinticInOut",
                        series: [
                            {
                                // symbol: "path://M30.9,53.2C16.8,53.2,5.3,41.7,5.3,27.6S16.8,2,30.9,2C45,2,56.4,13.5,56.4,27.6S45,53.2,30.9,53.2z M30.9,3.5C17.6,3.5,6.8,14.4,6.8,27.6c0,13.3,10.8,24.1,24.101,24.1C44.2,51.7,55,40.9,55,27.6C54.9,14.4,44.1,3.5,30.9,3.5z M36.9,35.8c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H36c0.5,0,0.9,0.4,0.9,1V35.8z M27.8,35.8 c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H27c0.5,0,0.9,0.4,0.9,1L27.8,35.8L27.8,35.8z",
                                symbol: "circle",
                                type: "graph",
                                layout: "none",
                                data: data.nodes.map((node) => ({
                                    ...node,
                                    category: categories.findIndex(
                                        (cat) => cat.name === node.value.Status,
                                    ),
                                })),
                                categories: categories,
                                links: data.links.map((link) => ({
                                    source: link.source.toString(),
                                    target: link.target.toString(),
                                })),
                                // categories: categories,
                                roam: true,
                                draggable: true,
                                label: {
                                    show: false,
                                },
                                symbolSize: [5, 5],
                                lineStyle: {
                                    color: "#9DA2DE",
                                    width: 1,
                                    curveness: 0.1,
                                },
                                emphasis: {
                                    focus: "adjacency",
                                    lineStyle: {
                                        width: 3,
                                    },
                                },

                                scaleLimit: {
                                    min: 0.1,
                                    max: 10,
                                },
                            },
                        ],
                    };

                    myChart.setOption(option);
                })
                .catch((error) => {
                    console.error("Error loading or processing data:", error);
                });
        </script>
    </body>
</html>
